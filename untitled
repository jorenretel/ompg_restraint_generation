

v1. Check whether peak is diagonal
v2. poor merit check
v3. peaks in range
v4. assigned peaks
5. fit to magnetization transfer pathway, resonance, bound indirect
6. labeling
7. distance on reference structure
8. round restraints
9. symmetry filtering


      peakDims = peak.sortedPeakDims()
      peakDim1 = peakDims[distIndices[0]]
      peakDim2 = peakDims[distIndices[1]]
      ppm1 = peakDim1.realValue
      ppm2 = peakDim2.realValue

      delta = abs(ppm1-ppm2)

      if (delta <= tolDict[distDim1][0] ) or (delta <= tolDict[distDim2][0]):
        dataDimA = bondedDims.get(distDim1)
        dataDimB = bondedDims.get(distDim2)

        if dataDimA and dataDimB :
          peakDimA = peak.findFirstPeakDim(dataDim=dataDimA)
          peakDimB = peak.findFirstPeakDim(dataDim=dataDimB)
          ppmA = pnt2ppm(peakDimA.position,peakDimA.dataDimRef)
          ppmB = pnt2ppm(peakDimB.position,peakDimB.dataDimRef)

          delta2 = abs(ppmA-ppmB)
          if (delta2 <= tolDict[dataDimA][0] ) or (delta2 <= tolDict[dataDimB][0]):
            diagonalPeaks.append(peak)
            continue

        else:
          diagonalPeaks.append(peak)
          continue